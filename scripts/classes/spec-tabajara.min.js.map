{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/specificity/specificity.js","scripts/classes/spec-tabajara.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"spec-tabajara.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","var SPECIFICITY = (function() {\n\tvar calculate,\n\t\tcalculateSingle,\n\t\tcompare;\n\n\t// Calculate the specificity for a selector by dividing it into simple selectors and counting them\n\tcalculate = function(input) {\n\t\tvar selectors,\n\t\t\tselector,\n\t\t\ti,\n\t\t\tlen,\n\t\t\tresults = [];\n\n\t\t// Separate input by commas\n\t\tselectors = input.split(',');\n\n\t\tfor (i = 0, len = selectors.length; i < len; i += 1) {\n\t\t\tselector = selectors[i];\n\t\t\tif (selector.length > 0) {\n\t\t\t\tresults.push(calculateSingle(selector));\n\t\t\t}\n\t\t}\n\n\t\treturn results;\n\t};\n\n\t/**\n\t * Calculates the specificity of CSS selectors\n\t * http://www.w3.org/TR/css3-selectors/#specificity\n\t *\n\t * Returns an object with the following properties:\n\t *  - selector: the input\n\t *  - specificity: e.g. 0,1,0,0\n\t *  - parts: array with details about each part of the selector that counts towards the specificity\n\t *  - specificityArray: e.g. [0, 1, 0, 0]\n\t */\n\tcalculateSingle = function(input) {\n\t\tvar selector = input,\n\t\t\tfindMatch,\n\t\t\ttypeCount = {\n\t\t\t\t'a': 0,\n\t\t\t\t'b': 0,\n\t\t\t\t'c': 0\n\t\t\t},\n\t\t\tparts = [],\n\t\t\t// The following regular expressions assume that selectors matching the preceding regular expressions have been removed\n\t\t\tattributeRegex = /(\\[[^\\]]+\\])/g,\n\t\t\tidRegex = /(#[^\\#\\s\\+>~\\.\\[:]+)/g,\n\t\t\tclassRegex = /(\\.[^\\s\\+>~\\.\\[:]+)/g,\n\t\t\tpseudoElementRegex = /(::[^\\s\\+>~\\.\\[:]+|:first-line|:first-letter|:before|:after)/gi,\n\t\t\t// A regex for pseudo classes with brackets - :nth-child(), :nth-last-child(), :nth-of-type(), :nth-last-type(), :lang()\n\t\t\tpseudoClassWithBracketsRegex = /(:[\\w-]+\\([^\\)]*\\))/gi,\n\t\t\t// A regex for other pseudo classes, which don't have brackets\n\t\t\tpseudoClassRegex = /(:[^\\s\\+>~\\.\\[:]+)/g,\n\t\t\telementRegex = /([^\\s\\+>~\\.\\[:]+)/g;\n\n\t\t// Find matches for a regular expression in a string and push their details to parts\n\t\t// Type is \"a\" for IDs, \"b\" for classes, attributes and pseudo-classes and \"c\" for elements and pseudo-elements\n\t\tfindMatch = function(regex, type) {\n\t\t\tvar matches, i, len, match, index, length;\n\t\t\tif (regex.test(selector)) {\n\t\t\t\tmatches = selector.match(regex);\n\t\t\t\tfor (i = 0, len = matches.length; i < len; i += 1) {\n\t\t\t\t\ttypeCount[type] += 1;\n\t\t\t\t\tmatch = matches[i];\n\t\t\t\t\tindex = selector.indexOf(match);\n\t\t\t\t\tlength = match.length;\n\t\t\t\t\tparts.push({\n\t\t\t\t\t\tselector: input.substr(index, length),\n\t\t\t\t\t\ttype: type,\n\t\t\t\t\t\tindex: index,\n\t\t\t\t\t\tlength: length\n\t\t\t\t\t});\n\t\t\t\t\t// Replace this simple selector with whitespace so it won't be counted in further simple selectors\n\t\t\t\t\tselector = selector.replace(match, Array(length + 1).join(' '));\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t// Replace escaped characters with plain text, using the \"A\" character\n\t\t// https://www.w3.org/TR/CSS21/syndata.html#characters\n\t\t(function() {\n\t\t\tvar replaceWithPlainText = function(regex) {\n\t\t\t\t\tvar matches, i, len, match;\n\t\t\t\t\tif (regex.test(selector)) {\n\t\t\t\t\t\tmatches = selector.match(regex);\n\t\t\t\t\t\tfor (i = 0, len = matches.length; i < len; i += 1) {\n\t\t\t\t\t\t\tmatch = matches[i];\n\t\t\t\t\t\t\tselector = selector.replace(match, Array(match.length + 1).join('A'));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t// Matches a backslash followed by six hexadecimal digits followed by an optional single whitespace character\n\t\t\t\tescapeHexadecimalRegex = /\\\\[0-9A-Fa-f]{6}\\s?/g,\n\t\t\t\t// Matches a backslash followed by fewer than six hexadecimal digits followed by a mandatory single whitespace character\n\t\t\t\tescapeHexadecimalRegex2 = /\\\\[0-9A-Fa-f]{1,5}\\s/g,\n\t\t\t\t// Matches a backslash followed by any character\n\t\t\t\tescapeSpecialCharacter = /\\\\./g;\n\n\t\t\treplaceWithPlainText(escapeHexadecimalRegex);\n\t\t\treplaceWithPlainText(escapeHexadecimalRegex2);\n\t\t\treplaceWithPlainText(escapeSpecialCharacter);\n\t\t}());\n\n\t\t// Remove the negation psuedo-class (:not) but leave its argument because specificity is calculated on its argument\n\t\t(function() {\n\t\t\tvar regex = /:not\\(([^\\)]*)\\)/g;\n\t\t\tif (regex.test(selector)) {\n\t\t\t\tselector = selector.replace(regex, '     $1 ');\n\t\t\t}\n\t\t}());\n\n\t\t// Remove anything after a left brace in case a user has pasted in a rule, not just a selector\n\t\t(function() {\n\t\t\tvar regex = /{[^]*/gm,\n\t\t\t\tmatches, i, len, match;\n\t\t\tif (regex.test(selector)) {\n\t\t\t\tmatches = selector.match(regex);\n\t\t\t\tfor (i = 0, len = matches.length; i < len; i += 1) {\n\t\t\t\t\tmatch = matches[i];\n\t\t\t\t\tselector = selector.replace(match, Array(match.length + 1).join(' '));\n\t\t\t\t}\n\t\t\t}\n\t\t}());\n\n\t\t// Add attribute selectors to parts collection (type b)\n\t\tfindMatch(attributeRegex, 'b');\n\n\t\t// Add ID selectors to parts collection (type a)\n\t\tfindMatch(idRegex, 'a');\n\n\t\t// Add class selectors to parts collection (type b)\n\t\tfindMatch(classRegex, 'b');\n\n\t\t// Add pseudo-element selectors to parts collection (type c)\n\t\tfindMatch(pseudoElementRegex, 'c');\n\n\t\t// Add pseudo-class selectors to parts collection (type b)\n\t\tfindMatch(pseudoClassWithBracketsRegex, 'b');\n\t\tfindMatch(pseudoClassRegex, 'b');\n\n\t\t// Remove universal selector and separator characters\n\t\tselector = selector.replace(/[\\*\\s\\+>~]/g, ' ');\n\n\t\t// Remove any stray dots or hashes which aren't attached to words\n\t\t// These may be present if the user is live-editing this selector\n\t\tselector = selector.replace(/[#\\.]/g, ' ');\n\n\t\t// The only things left should be element selectors (type c)\n\t\tfindMatch(elementRegex, 'c');\n\n\t\t// Order the parts in the order they appear in the original selector\n\t\t// This is neater for external apps to deal with\n\t\tparts.sort(function(a, b) {\n\t\t\treturn a.index - b.index;\n\t\t});\n\n\t\treturn {\n\t\t\tselector: input,\n\t\t\tspecificity: '0,' + typeCount.a.toString() + ',' + typeCount.b.toString() + ',' + typeCount.c.toString(),\n\t\t\tspecificityArray: [0, typeCount.a, typeCount.b, typeCount.c],\n\t\t\tparts: parts\n\t\t};\n\t};\n\n\t/**\n\t * Compares two CSS selectors for specificity\n\t * Alternatively you can replace one of the CSS selectors with a specificity array\n\t *\n\t *  - it returns -1 if a has a lower specificity than b\n\t *  - it returns 1 if a has a higher specificity than b\n\t *  - it returns 0 if a has the same specificity than b\n\t */\n\tcompare = function(a, b) {\n\t\tvar aSpecificity,\n\t\t\tbSpecificity,\n\t\t\ti;\n\n\t\tif (typeof a ==='string') {\n\t\t\tif (a.indexOf(',') !== -1) {\n\t\t\t\tthrow 'Invalid CSS selector';\n\t\t\t} else {\n\t\t\t\taSpecificity = calculateSingle(a)['specificityArray'];\n\t\t\t}\n\t\t} else if (Array.isArray(a)) {\n\t\t\tif (a.filter(function(e) { return (typeof e === 'number'); }).length !== 4) {\n\t\t\t\tthrow 'Invalid specificity array';\n\t\t\t} else {\n\t\t\t\taSpecificity = a;\n\t\t\t}\n\t\t} else {\n\t\t\tthrow 'Invalid CSS selector or specificity array';\n\t\t}\n\n\t\tif (typeof b ==='string') {\n\t\t\tif (b.indexOf(',') !== -1) {\n\t\t\t\tthrow 'Invalid CSS selector';\n\t\t\t} else {\n\t\t\t\tbSpecificity = calculateSingle(b)['specificityArray'];\n\t\t\t}\n\t\t} else if (Array.isArray(b)) {\n\t\t\tif (b.filter(function(e) { return (typeof e === 'number'); }).length !== 4) {\n\t\t\t\tthrow 'Invalid specificity array';\n\t\t\t} else {\n\t\t\t\tbSpecificity = b;\n\t\t\t}\n\t\t} else {\n\t\t\tthrow 'Invalid CSS selector or specificity array';\n\t\t}\n\n\t\tfor (i = 0; i < 4; i += 1) {\n\t\t\tif (aSpecificity[i] < bSpecificity[i]) {\n\t\t\t\treturn -1;\n\t\t\t} else if (aSpecificity[i] > bSpecificity[i]) {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t}\n\n\t\treturn 0;\n\t};\n\n\treturn {\n\t\tcalculate: calculate,\n\t\tcompare: compare\n\t};\n}());\n\n// Export for Node JS\nif (typeof exports !== 'undefined') {\n\texports.calculate = SPECIFICITY.calculate;\n\texports.compare = SPECIFICITY.compare;\n}\n","var spec = require('specificity'),\n\n    SpecificatorTabajara = function(inputEl, outputAEl, outputBEl,\n      outputCEl, buttonEl) {\n      this.inputEl = inputEl;\n      this.outputAEl = outputAEl;\n      this.outputBEl = outputBEl;\n      this.outputCEl = outputCEl;\n      this.buttonEl = buttonEl;\n    };\n\n// attaches the event handlers\nSpecificatorTabajara.prototype.start = function() {\n  var specificator = this;\n  this.buttonEl.onclick = function() {\n    specificator.calculate();\n  };\n};\n\nSpecificatorTabajara.prototype.calculate = function() {\n  // gets the value from the input\n  var input = this.inputEl.value,\n      result = spec.calculate(input)[0],\n      specificity;\n\n  if (result && result.specificity) {\n    result = result.specificity.split(',');\n  } else {\n    result = [0, 0, 0, 0];\n  }\n\n  // sets the value of the 3 outputs\n  this.outputAEl.innerHTML = result[1];\n  this.outputBEl.innerHTML = result[2];\n  this.outputCEl.innerHTML = result[3];\n};\n\n\nvar options = {\n  input: 'spec-tabajara-input',\n  output: [\n    'spec-tabajara-output-a',\n    'spec-tabajara-output-b',\n    'spec-tabajara-output-c'],\n  button: 'spec-tabajara-button'\n  },\n  inputEl = document.getElementById(options.input);\n\nif (inputEl) {\n  new SpecificatorTabajara(\n    inputEl,\n    document.getElementById(options.output[0]),\n    document.getElementById(options.output[1]),\n    document.getElementById(options.output[2]),\n    document.getElementById(options.button)\n  ).start();\n}\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvc3BlY2lmaWNpdHkvc3BlY2lmaWNpdHkuanMiLCJzY3JpcHRzL2NsYXNzZXMvc3BlYy10YWJhamFyYS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeE9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwidmFyIFNQRUNJRklDSVRZID0gKGZ1bmN0aW9uKCkge1xuXHR2YXIgY2FsY3VsYXRlLFxuXHRcdGNhbGN1bGF0ZVNpbmdsZSxcblx0XHRjb21wYXJlO1xuXG5cdC8vIENhbGN1bGF0ZSB0aGUgc3BlY2lmaWNpdHkgZm9yIGEgc2VsZWN0b3IgYnkgZGl2aWRpbmcgaXQgaW50byBzaW1wbGUgc2VsZWN0b3JzIGFuZCBjb3VudGluZyB0aGVtXG5cdGNhbGN1bGF0ZSA9IGZ1bmN0aW9uKGlucHV0KSB7XG5cdFx0dmFyIHNlbGVjdG9ycyxcblx0XHRcdHNlbGVjdG9yLFxuXHRcdFx0aSxcblx0XHRcdGxlbixcblx0XHRcdHJlc3VsdHMgPSBbXTtcblxuXHRcdC8vIFNlcGFyYXRlIGlucHV0IGJ5IGNvbW1hc1xuXHRcdHNlbGVjdG9ycyA9IGlucHV0LnNwbGl0KCcsJyk7XG5cblx0XHRmb3IgKGkgPSAwLCBsZW4gPSBzZWxlY3RvcnMubGVuZ3RoOyBpIDwgbGVuOyBpICs9IDEpIHtcblx0XHRcdHNlbGVjdG9yID0gc2VsZWN0b3JzW2ldO1xuXHRcdFx0aWYgKHNlbGVjdG9yLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0cmVzdWx0cy5wdXNoKGNhbGN1bGF0ZVNpbmdsZShzZWxlY3RvcikpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiByZXN1bHRzO1xuXHR9O1xuXG5cdC8qKlxuXHQgKiBDYWxjdWxhdGVzIHRoZSBzcGVjaWZpY2l0eSBvZiBDU1Mgc2VsZWN0b3JzXG5cdCAqIGh0dHA6Ly93d3cudzMub3JnL1RSL2NzczMtc2VsZWN0b3JzLyNzcGVjaWZpY2l0eVxuXHQgKlxuXHQgKiBSZXR1cm5zIGFuIG9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcblx0ICogIC0gc2VsZWN0b3I6IHRoZSBpbnB1dFxuXHQgKiAgLSBzcGVjaWZpY2l0eTogZS5nLiAwLDEsMCwwXG5cdCAqICAtIHBhcnRzOiBhcnJheSB3aXRoIGRldGFpbHMgYWJvdXQgZWFjaCBwYXJ0IG9mIHRoZSBzZWxlY3RvciB0aGF0IGNvdW50cyB0b3dhcmRzIHRoZSBzcGVjaWZpY2l0eVxuXHQgKiAgLSBzcGVjaWZpY2l0eUFycmF5OiBlLmcuIFswLCAxLCAwLCAwXVxuXHQgKi9cblx0Y2FsY3VsYXRlU2luZ2xlID0gZnVuY3Rpb24oaW5wdXQpIHtcblx0XHR2YXIgc2VsZWN0b3IgPSBpbnB1dCxcblx0XHRcdGZpbmRNYXRjaCxcblx0XHRcdHR5cGVDb3VudCA9IHtcblx0XHRcdFx0J2EnOiAwLFxuXHRcdFx0XHQnYic6IDAsXG5cdFx0XHRcdCdjJzogMFxuXHRcdFx0fSxcblx0XHRcdHBhcnRzID0gW10sXG5cdFx0XHQvLyBUaGUgZm9sbG93aW5nIHJlZ3VsYXIgZXhwcmVzc2lvbnMgYXNzdW1lIHRoYXQgc2VsZWN0b3JzIG1hdGNoaW5nIHRoZSBwcmVjZWRpbmcgcmVndWxhciBleHByZXNzaW9ucyBoYXZlIGJlZW4gcmVtb3ZlZFxuXHRcdFx0YXR0cmlidXRlUmVnZXggPSAvKFxcW1teXFxdXStcXF0pL2csXG5cdFx0XHRpZFJlZ2V4ID0gLygjW15cXCNcXHNcXCs+flxcLlxcWzpdKykvZyxcblx0XHRcdGNsYXNzUmVnZXggPSAvKFxcLlteXFxzXFwrPn5cXC5cXFs6XSspL2csXG5cdFx0XHRwc2V1ZG9FbGVtZW50UmVnZXggPSAvKDo6W15cXHNcXCs+flxcLlxcWzpdK3w6Zmlyc3QtbGluZXw6Zmlyc3QtbGV0dGVyfDpiZWZvcmV8OmFmdGVyKS9naSxcblx0XHRcdC8vIEEgcmVnZXggZm9yIHBzZXVkbyBjbGFzc2VzIHdpdGggYnJhY2tldHMgLSA6bnRoLWNoaWxkKCksIDpudGgtbGFzdC1jaGlsZCgpLCA6bnRoLW9mLXR5cGUoKSwgOm50aC1sYXN0LXR5cGUoKSwgOmxhbmcoKVxuXHRcdFx0cHNldWRvQ2xhc3NXaXRoQnJhY2tldHNSZWdleCA9IC8oOltcXHctXStcXChbXlxcKV0qXFwpKS9naSxcblx0XHRcdC8vIEEgcmVnZXggZm9yIG90aGVyIHBzZXVkbyBjbGFzc2VzLCB3aGljaCBkb24ndCBoYXZlIGJyYWNrZXRzXG5cdFx0XHRwc2V1ZG9DbGFzc1JlZ2V4ID0gLyg6W15cXHNcXCs+flxcLlxcWzpdKykvZyxcblx0XHRcdGVsZW1lbnRSZWdleCA9IC8oW15cXHNcXCs+flxcLlxcWzpdKykvZztcblxuXHRcdC8vIEZpbmQgbWF0Y2hlcyBmb3IgYSByZWd1bGFyIGV4cHJlc3Npb24gaW4gYSBzdHJpbmcgYW5kIHB1c2ggdGhlaXIgZGV0YWlscyB0byBwYXJ0c1xuXHRcdC8vIFR5cGUgaXMgXCJhXCIgZm9yIElEcywgXCJiXCIgZm9yIGNsYXNzZXMsIGF0dHJpYnV0ZXMgYW5kIHBzZXVkby1jbGFzc2VzIGFuZCBcImNcIiBmb3IgZWxlbWVudHMgYW5kIHBzZXVkby1lbGVtZW50c1xuXHRcdGZpbmRNYXRjaCA9IGZ1bmN0aW9uKHJlZ2V4LCB0eXBlKSB7XG5cdFx0XHR2YXIgbWF0Y2hlcywgaSwgbGVuLCBtYXRjaCwgaW5kZXgsIGxlbmd0aDtcblx0XHRcdGlmIChyZWdleC50ZXN0KHNlbGVjdG9yKSkge1xuXHRcdFx0XHRtYXRjaGVzID0gc2VsZWN0b3IubWF0Y2gocmVnZXgpO1xuXHRcdFx0XHRmb3IgKGkgPSAwLCBsZW4gPSBtYXRjaGVzLmxlbmd0aDsgaSA8IGxlbjsgaSArPSAxKSB7XG5cdFx0XHRcdFx0dHlwZUNvdW50W3R5cGVdICs9IDE7XG5cdFx0XHRcdFx0bWF0Y2ggPSBtYXRjaGVzW2ldO1xuXHRcdFx0XHRcdGluZGV4ID0gc2VsZWN0b3IuaW5kZXhPZihtYXRjaCk7XG5cdFx0XHRcdFx0bGVuZ3RoID0gbWF0Y2gubGVuZ3RoO1xuXHRcdFx0XHRcdHBhcnRzLnB1c2goe1xuXHRcdFx0XHRcdFx0c2VsZWN0b3I6IGlucHV0LnN1YnN0cihpbmRleCwgbGVuZ3RoKSxcblx0XHRcdFx0XHRcdHR5cGU6IHR5cGUsXG5cdFx0XHRcdFx0XHRpbmRleDogaW5kZXgsXG5cdFx0XHRcdFx0XHRsZW5ndGg6IGxlbmd0aFxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdC8vIFJlcGxhY2UgdGhpcyBzaW1wbGUgc2VsZWN0b3Igd2l0aCB3aGl0ZXNwYWNlIHNvIGl0IHdvbid0IGJlIGNvdW50ZWQgaW4gZnVydGhlciBzaW1wbGUgc2VsZWN0b3JzXG5cdFx0XHRcdFx0c2VsZWN0b3IgPSBzZWxlY3Rvci5yZXBsYWNlKG1hdGNoLCBBcnJheShsZW5ndGggKyAxKS5qb2luKCcgJykpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdC8vIFJlcGxhY2UgZXNjYXBlZCBjaGFyYWN0ZXJzIHdpdGggcGxhaW4gdGV4dCwgdXNpbmcgdGhlIFwiQVwiIGNoYXJhY3RlclxuXHRcdC8vIGh0dHBzOi8vd3d3LnczLm9yZy9UUi9DU1MyMS9zeW5kYXRhLmh0bWwjY2hhcmFjdGVyc1xuXHRcdChmdW5jdGlvbigpIHtcblx0XHRcdHZhciByZXBsYWNlV2l0aFBsYWluVGV4dCA9IGZ1bmN0aW9uKHJlZ2V4KSB7XG5cdFx0XHRcdFx0dmFyIG1hdGNoZXMsIGksIGxlbiwgbWF0Y2g7XG5cdFx0XHRcdFx0aWYgKHJlZ2V4LnRlc3Qoc2VsZWN0b3IpKSB7XG5cdFx0XHRcdFx0XHRtYXRjaGVzID0gc2VsZWN0b3IubWF0Y2gocmVnZXgpO1xuXHRcdFx0XHRcdFx0Zm9yIChpID0gMCwgbGVuID0gbWF0Y2hlcy5sZW5ndGg7IGkgPCBsZW47IGkgKz0gMSkge1xuXHRcdFx0XHRcdFx0XHRtYXRjaCA9IG1hdGNoZXNbaV07XG5cdFx0XHRcdFx0XHRcdHNlbGVjdG9yID0gc2VsZWN0b3IucmVwbGFjZShtYXRjaCwgQXJyYXkobWF0Y2gubGVuZ3RoICsgMSkuam9pbignQScpKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0sXG5cdFx0XHRcdC8vIE1hdGNoZXMgYSBiYWNrc2xhc2ggZm9sbG93ZWQgYnkgc2l4IGhleGFkZWNpbWFsIGRpZ2l0cyBmb2xsb3dlZCBieSBhbiBvcHRpb25hbCBzaW5nbGUgd2hpdGVzcGFjZSBjaGFyYWN0ZXJcblx0XHRcdFx0ZXNjYXBlSGV4YWRlY2ltYWxSZWdleCA9IC9cXFxcWzAtOUEtRmEtZl17Nn1cXHM/L2csXG5cdFx0XHRcdC8vIE1hdGNoZXMgYSBiYWNrc2xhc2ggZm9sbG93ZWQgYnkgZmV3ZXIgdGhhbiBzaXggaGV4YWRlY2ltYWwgZGlnaXRzIGZvbGxvd2VkIGJ5IGEgbWFuZGF0b3J5IHNpbmdsZSB3aGl0ZXNwYWNlIGNoYXJhY3RlclxuXHRcdFx0XHRlc2NhcGVIZXhhZGVjaW1hbFJlZ2V4MiA9IC9cXFxcWzAtOUEtRmEtZl17MSw1fVxccy9nLFxuXHRcdFx0XHQvLyBNYXRjaGVzIGEgYmFja3NsYXNoIGZvbGxvd2VkIGJ5IGFueSBjaGFyYWN0ZXJcblx0XHRcdFx0ZXNjYXBlU3BlY2lhbENoYXJhY3RlciA9IC9cXFxcLi9nO1xuXG5cdFx0XHRyZXBsYWNlV2l0aFBsYWluVGV4dChlc2NhcGVIZXhhZGVjaW1hbFJlZ2V4KTtcblx0XHRcdHJlcGxhY2VXaXRoUGxhaW5UZXh0KGVzY2FwZUhleGFkZWNpbWFsUmVnZXgyKTtcblx0XHRcdHJlcGxhY2VXaXRoUGxhaW5UZXh0KGVzY2FwZVNwZWNpYWxDaGFyYWN0ZXIpO1xuXHRcdH0oKSk7XG5cblx0XHQvLyBSZW1vdmUgdGhlIG5lZ2F0aW9uIHBzdWVkby1jbGFzcyAoOm5vdCkgYnV0IGxlYXZlIGl0cyBhcmd1bWVudCBiZWNhdXNlIHNwZWNpZmljaXR5IGlzIGNhbGN1bGF0ZWQgb24gaXRzIGFyZ3VtZW50XG5cdFx0KGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIHJlZ2V4ID0gLzpub3RcXCgoW15cXCldKilcXCkvZztcblx0XHRcdGlmIChyZWdleC50ZXN0KHNlbGVjdG9yKSkge1xuXHRcdFx0XHRzZWxlY3RvciA9IHNlbGVjdG9yLnJlcGxhY2UocmVnZXgsICcgICAgICQxICcpO1xuXHRcdFx0fVxuXHRcdH0oKSk7XG5cblx0XHQvLyBSZW1vdmUgYW55dGhpbmcgYWZ0ZXIgYSBsZWZ0IGJyYWNlIGluIGNhc2UgYSB1c2VyIGhhcyBwYXN0ZWQgaW4gYSBydWxlLCBub3QganVzdCBhIHNlbGVjdG9yXG5cdFx0KGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIHJlZ2V4ID0gL3tbXl0qL2dtLFxuXHRcdFx0XHRtYXRjaGVzLCBpLCBsZW4sIG1hdGNoO1xuXHRcdFx0aWYgKHJlZ2V4LnRlc3Qoc2VsZWN0b3IpKSB7XG5cdFx0XHRcdG1hdGNoZXMgPSBzZWxlY3Rvci5tYXRjaChyZWdleCk7XG5cdFx0XHRcdGZvciAoaSA9IDAsIGxlbiA9IG1hdGNoZXMubGVuZ3RoOyBpIDwgbGVuOyBpICs9IDEpIHtcblx0XHRcdFx0XHRtYXRjaCA9IG1hdGNoZXNbaV07XG5cdFx0XHRcdFx0c2VsZWN0b3IgPSBzZWxlY3Rvci5yZXBsYWNlKG1hdGNoLCBBcnJheShtYXRjaC5sZW5ndGggKyAxKS5qb2luKCcgJykpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSgpKTtcblxuXHRcdC8vIEFkZCBhdHRyaWJ1dGUgc2VsZWN0b3JzIHRvIHBhcnRzIGNvbGxlY3Rpb24gKHR5cGUgYilcblx0XHRmaW5kTWF0Y2goYXR0cmlidXRlUmVnZXgsICdiJyk7XG5cblx0XHQvLyBBZGQgSUQgc2VsZWN0b3JzIHRvIHBhcnRzIGNvbGxlY3Rpb24gKHR5cGUgYSlcblx0XHRmaW5kTWF0Y2goaWRSZWdleCwgJ2EnKTtcblxuXHRcdC8vIEFkZCBjbGFzcyBzZWxlY3RvcnMgdG8gcGFydHMgY29sbGVjdGlvbiAodHlwZSBiKVxuXHRcdGZpbmRNYXRjaChjbGFzc1JlZ2V4LCAnYicpO1xuXG5cdFx0Ly8gQWRkIHBzZXVkby1lbGVtZW50IHNlbGVjdG9ycyB0byBwYXJ0cyBjb2xsZWN0aW9uICh0eXBlIGMpXG5cdFx0ZmluZE1hdGNoKHBzZXVkb0VsZW1lbnRSZWdleCwgJ2MnKTtcblxuXHRcdC8vIEFkZCBwc2V1ZG8tY2xhc3Mgc2VsZWN0b3JzIHRvIHBhcnRzIGNvbGxlY3Rpb24gKHR5cGUgYilcblx0XHRmaW5kTWF0Y2gocHNldWRvQ2xhc3NXaXRoQnJhY2tldHNSZWdleCwgJ2InKTtcblx0XHRmaW5kTWF0Y2gocHNldWRvQ2xhc3NSZWdleCwgJ2InKTtcblxuXHRcdC8vIFJlbW92ZSB1bml2ZXJzYWwgc2VsZWN0b3IgYW5kIHNlcGFyYXRvciBjaGFyYWN0ZXJzXG5cdFx0c2VsZWN0b3IgPSBzZWxlY3Rvci5yZXBsYWNlKC9bXFwqXFxzXFwrPn5dL2csICcgJyk7XG5cblx0XHQvLyBSZW1vdmUgYW55IHN0cmF5IGRvdHMgb3IgaGFzaGVzIHdoaWNoIGFyZW4ndCBhdHRhY2hlZCB0byB3b3Jkc1xuXHRcdC8vIFRoZXNlIG1heSBiZSBwcmVzZW50IGlmIHRoZSB1c2VyIGlzIGxpdmUtZWRpdGluZyB0aGlzIHNlbGVjdG9yXG5cdFx0c2VsZWN0b3IgPSBzZWxlY3Rvci5yZXBsYWNlKC9bI1xcLl0vZywgJyAnKTtcblxuXHRcdC8vIFRoZSBvbmx5IHRoaW5ncyBsZWZ0IHNob3VsZCBiZSBlbGVtZW50IHNlbGVjdG9ycyAodHlwZSBjKVxuXHRcdGZpbmRNYXRjaChlbGVtZW50UmVnZXgsICdjJyk7XG5cblx0XHQvLyBPcmRlciB0aGUgcGFydHMgaW4gdGhlIG9yZGVyIHRoZXkgYXBwZWFyIGluIHRoZSBvcmlnaW5hbCBzZWxlY3RvclxuXHRcdC8vIFRoaXMgaXMgbmVhdGVyIGZvciBleHRlcm5hbCBhcHBzIHRvIGRlYWwgd2l0aFxuXHRcdHBhcnRzLnNvcnQoZnVuY3Rpb24oYSwgYikge1xuXHRcdFx0cmV0dXJuIGEuaW5kZXggLSBiLmluZGV4O1xuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIHtcblx0XHRcdHNlbGVjdG9yOiBpbnB1dCxcblx0XHRcdHNwZWNpZmljaXR5OiAnMCwnICsgdHlwZUNvdW50LmEudG9TdHJpbmcoKSArICcsJyArIHR5cGVDb3VudC5iLnRvU3RyaW5nKCkgKyAnLCcgKyB0eXBlQ291bnQuYy50b1N0cmluZygpLFxuXHRcdFx0c3BlY2lmaWNpdHlBcnJheTogWzAsIHR5cGVDb3VudC5hLCB0eXBlQ291bnQuYiwgdHlwZUNvdW50LmNdLFxuXHRcdFx0cGFydHM6IHBhcnRzXG5cdFx0fTtcblx0fTtcblxuXHQvKipcblx0ICogQ29tcGFyZXMgdHdvIENTUyBzZWxlY3RvcnMgZm9yIHNwZWNpZmljaXR5XG5cdCAqIEFsdGVybmF0aXZlbHkgeW91IGNhbiByZXBsYWNlIG9uZSBvZiB0aGUgQ1NTIHNlbGVjdG9ycyB3aXRoIGEgc3BlY2lmaWNpdHkgYXJyYXlcblx0ICpcblx0ICogIC0gaXQgcmV0dXJucyAtMSBpZiBhIGhhcyBhIGxvd2VyIHNwZWNpZmljaXR5IHRoYW4gYlxuXHQgKiAgLSBpdCByZXR1cm5zIDEgaWYgYSBoYXMgYSBoaWdoZXIgc3BlY2lmaWNpdHkgdGhhbiBiXG5cdCAqICAtIGl0IHJldHVybnMgMCBpZiBhIGhhcyB0aGUgc2FtZSBzcGVjaWZpY2l0eSB0aGFuIGJcblx0ICovXG5cdGNvbXBhcmUgPSBmdW5jdGlvbihhLCBiKSB7XG5cdFx0dmFyIGFTcGVjaWZpY2l0eSxcblx0XHRcdGJTcGVjaWZpY2l0eSxcblx0XHRcdGk7XG5cblx0XHRpZiAodHlwZW9mIGEgPT09J3N0cmluZycpIHtcblx0XHRcdGlmIChhLmluZGV4T2YoJywnKSAhPT0gLTEpIHtcblx0XHRcdFx0dGhyb3cgJ0ludmFsaWQgQ1NTIHNlbGVjdG9yJztcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGFTcGVjaWZpY2l0eSA9IGNhbGN1bGF0ZVNpbmdsZShhKVsnc3BlY2lmaWNpdHlBcnJheSddO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShhKSkge1xuXHRcdFx0aWYgKGEuZmlsdGVyKGZ1bmN0aW9uKGUpIHsgcmV0dXJuICh0eXBlb2YgZSA9PT0gJ251bWJlcicpOyB9KS5sZW5ndGggIT09IDQpIHtcblx0XHRcdFx0dGhyb3cgJ0ludmFsaWQgc3BlY2lmaWNpdHkgYXJyYXknO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0YVNwZWNpZmljaXR5ID0gYTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhyb3cgJ0ludmFsaWQgQ1NTIHNlbGVjdG9yIG9yIHNwZWNpZmljaXR5IGFycmF5Jztcblx0XHR9XG5cblx0XHRpZiAodHlwZW9mIGIgPT09J3N0cmluZycpIHtcblx0XHRcdGlmIChiLmluZGV4T2YoJywnKSAhPT0gLTEpIHtcblx0XHRcdFx0dGhyb3cgJ0ludmFsaWQgQ1NTIHNlbGVjdG9yJztcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGJTcGVjaWZpY2l0eSA9IGNhbGN1bGF0ZVNpbmdsZShiKVsnc3BlY2lmaWNpdHlBcnJheSddO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShiKSkge1xuXHRcdFx0aWYgKGIuZmlsdGVyKGZ1bmN0aW9uKGUpIHsgcmV0dXJuICh0eXBlb2YgZSA9PT0gJ251bWJlcicpOyB9KS5sZW5ndGggIT09IDQpIHtcblx0XHRcdFx0dGhyb3cgJ0ludmFsaWQgc3BlY2lmaWNpdHkgYXJyYXknO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0YlNwZWNpZmljaXR5ID0gYjtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhyb3cgJ0ludmFsaWQgQ1NTIHNlbGVjdG9yIG9yIHNwZWNpZmljaXR5IGFycmF5Jztcblx0XHR9XG5cblx0XHRmb3IgKGkgPSAwOyBpIDwgNDsgaSArPSAxKSB7XG5cdFx0XHRpZiAoYVNwZWNpZmljaXR5W2ldIDwgYlNwZWNpZmljaXR5W2ldKSB7XG5cdFx0XHRcdHJldHVybiAtMTtcblx0XHRcdH0gZWxzZSBpZiAoYVNwZWNpZmljaXR5W2ldID4gYlNwZWNpZmljaXR5W2ldKSB7XG5cdFx0XHRcdHJldHVybiAxO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiAwO1xuXHR9O1xuXG5cdHJldHVybiB7XG5cdFx0Y2FsY3VsYXRlOiBjYWxjdWxhdGUsXG5cdFx0Y29tcGFyZTogY29tcGFyZVxuXHR9O1xufSgpKTtcblxuLy8gRXhwb3J0IGZvciBOb2RlIEpTXG5pZiAodHlwZW9mIGV4cG9ydHMgIT09ICd1bmRlZmluZWQnKSB7XG5cdGV4cG9ydHMuY2FsY3VsYXRlID0gU1BFQ0lGSUNJVFkuY2FsY3VsYXRlO1xuXHRleHBvcnRzLmNvbXBhcmUgPSBTUEVDSUZJQ0lUWS5jb21wYXJlO1xufVxuIiwidmFyIHNwZWMgPSByZXF1aXJlKCdzcGVjaWZpY2l0eScpLFxuXG4gICAgU3BlY2lmaWNhdG9yVGFiYWphcmEgPSBmdW5jdGlvbihpbnB1dEVsLCBvdXRwdXRBRWwsIG91dHB1dEJFbCxcbiAgICAgIG91dHB1dENFbCwgYnV0dG9uRWwpIHtcbiAgICAgIHRoaXMuaW5wdXRFbCA9IGlucHV0RWw7XG4gICAgICB0aGlzLm91dHB1dEFFbCA9IG91dHB1dEFFbDtcbiAgICAgIHRoaXMub3V0cHV0QkVsID0gb3V0cHV0QkVsO1xuICAgICAgdGhpcy5vdXRwdXRDRWwgPSBvdXRwdXRDRWw7XG4gICAgICB0aGlzLmJ1dHRvbkVsID0gYnV0dG9uRWw7XG4gICAgfTtcblxuLy8gYXR0YWNoZXMgdGhlIGV2ZW50IGhhbmRsZXJzXG5TcGVjaWZpY2F0b3JUYWJhamFyYS5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbigpIHtcbiAgdmFyIHNwZWNpZmljYXRvciA9IHRoaXM7XG4gIHRoaXMuYnV0dG9uRWwub25jbGljayA9IGZ1bmN0aW9uKCkge1xuICAgIHNwZWNpZmljYXRvci5jYWxjdWxhdGUoKTtcbiAgfTtcbn07XG5cblNwZWNpZmljYXRvclRhYmFqYXJhLnByb3RvdHlwZS5jYWxjdWxhdGUgPSBmdW5jdGlvbigpIHtcbiAgLy8gZ2V0cyB0aGUgdmFsdWUgZnJvbSB0aGUgaW5wdXRcbiAgdmFyIGlucHV0ID0gdGhpcy5pbnB1dEVsLnZhbHVlLFxuICAgICAgcmVzdWx0ID0gc3BlYy5jYWxjdWxhdGUoaW5wdXQpWzBdLFxuICAgICAgc3BlY2lmaWNpdHk7XG5cbiAgaWYgKHJlc3VsdCAmJiByZXN1bHQuc3BlY2lmaWNpdHkpIHtcbiAgICByZXN1bHQgPSByZXN1bHQuc3BlY2lmaWNpdHkuc3BsaXQoJywnKTtcbiAgfSBlbHNlIHtcbiAgICByZXN1bHQgPSBbMCwgMCwgMCwgMF07XG4gIH1cblxuICAvLyBzZXRzIHRoZSB2YWx1ZSBvZiB0aGUgMyBvdXRwdXRzXG4gIHRoaXMub3V0cHV0QUVsLmlubmVySFRNTCA9IHJlc3VsdFsxXTtcbiAgdGhpcy5vdXRwdXRCRWwuaW5uZXJIVE1MID0gcmVzdWx0WzJdO1xuICB0aGlzLm91dHB1dENFbC5pbm5lckhUTUwgPSByZXN1bHRbM107XG59O1xuXG5cbnZhciBvcHRpb25zID0ge1xuICBpbnB1dDogJ3NwZWMtdGFiYWphcmEtaW5wdXQnLFxuICBvdXRwdXQ6IFtcbiAgICAnc3BlYy10YWJhamFyYS1vdXRwdXQtYScsXG4gICAgJ3NwZWMtdGFiYWphcmEtb3V0cHV0LWInLFxuICAgICdzcGVjLXRhYmFqYXJhLW91dHB1dC1jJ10sXG4gIGJ1dHRvbjogJ3NwZWMtdGFiYWphcmEtYnV0dG9uJ1xuICB9LFxuICBpbnB1dEVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQob3B0aW9ucy5pbnB1dCk7XG5cbmlmIChpbnB1dEVsKSB7XG4gIG5ldyBTcGVjaWZpY2F0b3JUYWJhamFyYShcbiAgICBpbnB1dEVsLFxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG9wdGlvbnMub3V0cHV0WzBdKSxcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChvcHRpb25zLm91dHB1dFsxXSksXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQob3B0aW9ucy5vdXRwdXRbMl0pLFxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG9wdGlvbnMuYnV0dG9uKVxuICApLnN0YXJ0KCk7XG59XG4iXX0="}